import pg from "pg";
import { drizzle } from "drizzle-orm/node-postgres";
import * as schema from "../shared/schema";

async function seed() {
  const pool = new pg.Pool({ connectionString: process.env.DATABASE_URL });
  const db = drizzle(pool, { schema });

  const existingPaths = await db.select().from(schema.paths);
  if (existingPaths.length > 0) {
    console.log("دیتابیس قبلاً مقداردهی اولیه شده است؛ از این مرحله عبور شد.");
    await pool.end();
    return;
  }

  const [path] = await db
    .insert(schema.paths)
    .values({
      title: "مبانی مدیریت مالی شخصی",
      description:
        "با اصول پایه مدیریت مالی شخصی آشنا شوید: بودجه‌بندی، پس‌انداز، مدیریت بدهی، مفاهیم سرمایه‌گذاری و برنامه‌ریزی بلندمدت.",
      orderIndex: 0,
      iconName: "trending-up",
      colorHex: "#00B87C",
    })
    .returning();

  const skillsData = [
    {
      title: "اصول بودجه‌بندی",
      description: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید.",
      orderIndex: 0,
      iconName: "pie-chart",
    },
    {
      title: "پس‌انداز و صندوق اضطراری",
      description: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
      orderIndex: 1,
      iconName: "shield",
    },
    {
      title: "مبانی بدهی و اعتبار",
      description: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
      orderIndex: 2,
      iconName: "credit-card",
    },
    {
      title: "مبانی سرمایه‌گذاری",
      description: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
      orderIndex: 3,
      iconName: "bar-chart-2",
    },
    {
      title: "ریسک و برنامه‌ریزی بلندمدت",
      description: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
      orderIndex: 4,
      iconName: "target",
    },
  ];

  const insertedSkills = await db
    .insert(schema.skills)
    .values(skillsData.map((s) => ({ ...s, pathId: path.id })))
    .returning();

  const lessonsMap: Record<string, { title: string; content: any[] }[]> = {
    "اصول بودجه‌بندی": [
      {
        title: "بودجه چیست؟",
        content: [
          { type: "read", text: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "درآمد در برابر هزینه",
        content: [
          { type: "read", text: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید." },
          { type: "read", text: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید." },
        ],
      },
      {
        title: "هزینه‌های ثابت و متغیر",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "قانون ۵۰/۳۰/۲۰",
        content: [
          { type: "read", text: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "پیگیری هزینه‌ها",
        content: [
          { type: "read", text: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "ساخت اولین بودجه",
        content: [
          { type: "read", text: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید." },
          { type: "read", text: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید." },
        ],
      },
    ],
    "پس‌انداز و صندوق اضطراری": [
      {
        title: "چرا پس‌انداز کنیم؟",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "اول به خودتان پرداخت کنید",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "اصول صندوق اضطراری",
        content: [
          { type: "read", text: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "پس‌انداز را کجا نگه داریم؟",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید." },
        ],
      },
      {
        title: "استراتژی‌های پس‌انداز",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "تعیین اهداف پس‌انداز",
        content: [
          { type: "read", text: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
    ],
    "مبانی بدهی و اعتبار": [
      {
        title: "درک بدهی",
        content: [
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
        ],
      },
      {
        title: "نحوه کار سود",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
        ],
      },
      {
        title: "توضیح امتیاز اعتباری",
        content: [
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
        ],
      },
      {
        title: "روش گلوله‌برفی (Snowball)",
        content: [
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
        ],
      },
      {
        title: "روش بهمن بدهی (Avalanche)",
        content: [
          { type: "read", text: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "استفاده درست از اعتبار",
        content: [
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
          { type: "read", text: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید." },
        ],
      },
    ],
    "مبانی سرمایه‌گذاری": [
      {
        title: "چرا سرمایه‌گذاری کنیم؟",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
        ],
      },
      {
        title: "سهام و اوراق",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
        ],
      },
      {
        title: "صندوق‌های شاخص و ETFها",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
        ],
      },
      {
        title: "رشد مرکب",
        content: [
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
      {
        title: "میانگین‌گیری هزینه دلاری (DCA)",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
        ],
      },
      {
        title: "Diversification",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
    ],
    "ریسک و برنامه‌ریزی بلندمدت": [
      {
        title: "درک ریسک",
        content: [
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "تحمل ریسک",
        content: [
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
          { type: "read", text: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید." },
        ],
      },
      {
        title: "اصول بیمه",
        content: [
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "حساب‌های بازنشستگی",
        content: [
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "تعیین اهداف مالی",
        content: [
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
          { type: "read", text: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی." },
        ],
      },
      {
        title: "ساخت برنامه مالی",
        content: [
          { type: "read", text: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید." },
          { type: "read", text: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید." },
        ],
      },
    ],
  };

  const exercisesMap: Record<string, { lessonTitle: string; exercises: any[] }[]> = {
    "اصول بودجه‌بندی": [
      {
        lessonTitle: "بودجه چیست؟",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "هدف اصلی بودجه چیست؟",
            options: ["برای محدود کردن همه هزینه‌ها", "برای برنامه‌ریزی مسیر خرج پول", "برای کسب درآمد بیشتر", "برای فرار از مالیات"],
            answer: { correct: 1 },
            explanation: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
          {
            type: "true_false",
            prompt: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید.",
            options: null,
            answer: { correct: false },
            explanation: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید.",
            hint: "به قانون ۵۰/۳۰/۲۰ فکر کنید.",
          },
        ],
      },
      {
        lessonTitle: "درآمد در برابر هزینه",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            options: ["Salary", "دریافت فریلنسری", "مانده کارت اعتباری", "درآمد کار جانبی"],
            answer: { correct: 2 },
            explanation: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            hint: "درآمد پولی است که به شما وارد می‌شود.",
          },
        ],
      },
      {
        lessonTitle: "قانون ۵۰/۳۰/۲۰",
        exercises: [
          {
            type: "numeric",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: null,
            answer: { correct: 50, min: 50, max: 50 },
            explanation: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
          {
            type: "multiple_choice",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: ["نیازها (۵۰٪)", "خواسته‌ها (۳۰٪)", "پس‌انداز (۲۰٪)", "هیچ‌کدام"],
            answer: { correct: 1 },
            explanation: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            hint: "آیا بدون آن می‌توانید دوام بیاورید؟",
          },
        ],
      },
      {
        lessonTitle: "پیگیری هزینه‌ها",
        exercises: [
          {
            type: "true_false",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: null,
            answer: { correct: true },
            explanation: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            hint: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
          },
        ],
      },
    ],
    "پس‌انداز و صندوق اضطراری": [
      {
        lessonTitle: "چرا پس‌انداز کنیم؟",
        exercises: [
          {
            type: "numeric",
            prompt: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید.",
            options: null,
            answer: { correct: 1825, min: 1825, max: 1825 },
            explanation: "مثال: پس‌اندازهای کوچک روزانه در طول سال جمع می‌شوند و عدد قابل توجهی می‌سازند (اعداد تقریبی هستند).",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
      {
        lessonTitle: "اول به خودتان پرداخت کنید",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "«اول به خودتان پرداخت کنید» یعنی چه؟",
            options: ["قبل از پرداخت قبض‌ها هرچه خواستید بخرید", "قبل از سایر هزینه‌ها پس‌انداز کنید", "اول بدهی کارت اعتباری را بپردازید", "پول نقد را در خانه نگه دارید"],
            answer: { correct: 1 },
            explanation: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
      {
        lessonTitle: "اصول صندوق اضطراری",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            options: ["۱ ماه", "۳ تا ۶ ماه", "۱۲ ماه", "۲۴ ماه"],
            answer: { correct: 1 },
            explanation: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
          {
            type: "true_false",
            prompt: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید.",
            options: null,
            answer: { correct: false },
            explanation: "درآمدها و هزینه‌ها را تفکیک کنید و با ثبت منظم آن‌ها، تصویر دقیقی از وضعیت مالی خود بسازید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
    ],
    "مبانی بدهی و اعتبار": [
      {
        lessonTitle: "درک بدهی",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            options: ["بدهی کارت اعتباری", "وام‌های کوتاه‌مدت/روزپرداخت", "وام مسکن برای خرید خانه", "اعتبار/قسط فروشگاهی"],
            answer: { correct: 2 },
            explanation: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
      {
        lessonTitle: "نحوه کار سود",
        exercises: [
          {
            type: "numeric",
            prompt: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            options: null,
            answer: { correct: 1000, min: 950, max: 1050 },
            explanation: "مثال: نرخ سود بالا می‌تواند هزینه سالانه قابل توجهی ایجاد کند (اعداد تقریبی هستند).",
            hint: "مانده را در نرخ سالانه ضرب کنید.",
          },
        ],
      },
      {
        lessonTitle: "توضیح امتیاز اعتباری",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            options: ["طول سابقه اعتباری", "سابقه پرداخت", "ترکیب اعتباری", "استعلام‌های جدید اعتباری"],
            answer: { correct: 1 },
            explanation: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            hint: "۳۵٪ از امتیاز شما را تشکیل می‌دهد.",
          },
          {
            type: "numeric",
            prompt: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            options: null,
            answer: { correct: 35, min: 35, max: 35 },
            explanation: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            hint: "بزرگ‌ترین بخش را تشکیل می‌دهد.",
          },
        ],
      },
      {
        lessonTitle: "روش گلوله‌برفی (Snowball)",
        exercises: [
          {
            type: "true_false",
            prompt: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
            options: null,
            answer: { correct: false },
            explanation: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
    ],
    "مبانی سرمایه‌گذاری": [
      {
        lessonTitle: "چرا سرمایه‌گذاری کنیم؟",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            options: ["1-3%", "4-6%", "7-10%", "15-20%"],
            answer: { correct: 2 },
            explanation: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
      {
        lessonTitle: "سهام و اوراق",
        exercises: [
          {
            type: "true_false",
            prompt: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            options: null,
            answer: { correct: false },
            explanation: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            hint: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
          },
          {
            type: "multiple_choice",
            prompt: "مالکیت سهم چه مفهومی دارد؟",
            options: ["وام به یک شرکت", "مالکیت در یک شرکت", "یک حساب پس‌انداز", "نوعی بیمه"],
            answer: { correct: 1 },
            explanation: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            hint: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
          },
        ],
      },
      {
        lessonTitle: "رشد مرکب",
        exercises: [
          {
            type: "numeric",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: null,
            answer: { correct: 2159, min: 2100, max: 2200 },
            explanation: "مثال: رشد مرکب در طول زمان می‌تواند مبلغ اولیه را به‌طور قابل‌توجهی افزایش دهد (اعداد تقریبی هستند).",
            hint: "از فرمول «مبلغ × (۱ + نرخ)^سال» استفاده کنید.",
          },
        ],
      },
      {
        lessonTitle: "میانگین‌گیری هزینه دلاری (DCA)",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: ["سود تضمینی", "احساسات را از تصمیم سرمایه‌گذاری حذف می‌کند", "بازده بالقوه بیشتر از خرید یک‌باره", "تمام ریسک را حذف می‌کند"],
            answer: { correct: 1 },
            explanation: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            hint: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
          },
        ],
      },
    ],
    "ریسک و برنامه‌ریزی بلندمدت": [
      {
        lessonTitle: "درک ریسک",
        exercises: [
          {
            type: "true_false",
            prompt: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
            options: null,
            answer: { correct: true },
            explanation: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            hint: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
          },
        ],
      },
      {
        lessonTitle: "تحمل ریسک",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
            options: ["یک فرد ۶۰ ساله نزدیک بازنشستگی", "یک فرد ۲۵ ساله در شروع مسیر شغلی", "کسی که صندوق اضطراری ندارد", "کسی که بدهی کارت اعتباری زیادی دارد"],
            answer: { correct: 1 },
            explanation: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
            hint: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
          },
        ],
      },
      {
        lessonTitle: "حساب‌های بازنشستگی",
        exercises: [
          {
            type: "multiple_choice",
            prompt: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
            options: ["با نرخ پایین‌تری مالیات می‌گیرد", "عملاً پول رایگان محسوب می‌شود", "به‌طور تضمینی رشد می‌کند", "سقف واریز مشخصی ندارد"],
            answer: { correct: 1 },
            explanation: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
          {
            type: "true_false",
            prompt: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
            options: null,
            answer: { correct: false },
            explanation: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
            hint: "این بخش آموزشی برای یادگیری مفاهیم کلیدی طراحی شده است و به شما کمک می‌کند تصمیم‌های مالی آگاهانه‌تری بگیرید.",
          },
        ],
      },
    ],
  };

  const projectsData = [
    {
      skillTitle: "اصول بودجه‌بندی",
      title: "سازنده بودجه ماهانه",
      description: "در این بخش با بودجه‌بندی و روش‌های کنترل هزینه‌ها آشنا می‌شوید تا دخل‌وخرج خود را بهتر مدیریت کنید.",
      schemaJson: {
        fields: [
          { key: "monthlyIncome", label: "درآمد ماهانه پس از کسر مالیات", type: "number", required: true },
          { key: "rent", label: "اجاره / وام مسکن", type: "number", required: true },
          { key: "utilities", label: "Utilities", type: "number", required: true },
          { key: "insurance", label: "Insurance", type: "number", required: true },
          { key: "groceries", label: "Groceries", type: "number", required: true },
          { key: "transportation", label: "Transportation", type: "number", required: true },
          { key: "dining", label: "غذا خوردن بیرون", type: "number", required: false },
          { key: "entertainment", label: "Entertainment", type: "number", required: false },
          { key: "subscriptions", label: "Subscriptions", type: "number", required: false },
          { key: "savings", label: "هدف پس‌انداز", type: "number", required: true },
        ],
        computations: ["totalExpenses", "remainingIncome", "needsPercent", "wantsPercent", "savingsPercent"],
      },
    },
    {
      skillTitle: "پس‌انداز و صندوق اضطراری",
      title: "طرح صندوق اضطراری",
      description: "پس‌انداز منظم و ایجاد صندوق اضطراری به شما کمک می‌کند در شرایط پیش‌بینی‌نشده آرامش بیشتری داشته باشید.",
      schemaJson: {
        fields: [
          { key: "monthlyExpenses", label: "هزینه‌های ضروری ماهانه", type: "number", required: true },
          { key: "targetMonths", label: "تعداد ماه‌های پوشش هدف", type: "number", required: true },
          { key: "currentSavings", label: "پس‌انداز فعلی", type: "number", required: true },
          { key: "monthlySavingAmount", label: "مبلغی که ماهانه می‌توانید پس‌انداز کنید", type: "number", required: true },
        ],
        computations: ["targetAmount", "amountNeeded", "monthsToGoal"],
      },
    },
    {
      skillTitle: "مبانی بدهی و اعتبار",
      title: "شبیه‌ساز تسویه بدهی",
      description: "در این بخش مفاهیم بدهی و اعتبار را مرور می‌کنیم و روش‌های کاهش بدهی و مدیریت مسئولانه را یاد می‌گیرید.",
      schemaJson: {
        fields: [
          { key: "debt1Name", label: "نام بدهی ۱", type: "text", required: true },
          { key: "debt1Balance", label: "مانده بدهی ۱", type: "number", required: true },
          { key: "debt1Rate", label: "نرخ سود بدهی ۱ (%)", type: "number", required: true },
          { key: "debt1MinPayment", label: "حداقل پرداخت بدهی ۱", type: "number", required: true },
          { key: "debt2Name", label: "نام بدهی ۲", type: "text", required: false },
          { key: "debt2Balance", label: "مانده بدهی ۲", type: "number", required: false },
          { key: "debt2Rate", label: "نرخ سود بدهی ۲ (%)", type: "number", required: false },
          { key: "debt2MinPayment", label: "حداقل پرداخت بدهی ۲", type: "number", required: false },
          { key: "extraMonthly", label: "پرداخت اضافه ماهانه", type: "number", required: true },
        ],
        computations: ["snowballMonths", "avalancheMonths", "snowballInterest", "avalancheInterest"],
      },
    },
    {
      skillTitle: "مبانی سرمایه‌گذاری",
      title: "شبیه‌ساز سرمایه‌گذاری",
      description: "با اصول سرمایه‌گذاری و ابزارهای رایج آشنا می‌شوید و یاد می‌گیرید چگونه ریسک و بازده را متعادل کنید.",
      schemaJson: {
        fields: [
          { key: "totalAmount", label: "مجموع مبلغ سرمایه‌گذاری", type: "number", required: true },
          { key: "monthlyContribution", label: "مبلغ ماهانه میانگین‌گیری (DCA)", type: "number", required: true },
          { key: "annualReturn", label: "بازده سالانه مورد انتظار (%)", type: "number", required: true },
          { key: "years", label: "دوره سرمایه‌گذاری (سال)", type: "number", required: true },
        ],
        computations: ["lumpSumResult", "dcaResult", "difference"],
      },
    },
    {
      skillTitle: "ریسک و برنامه‌ریزی بلندمدت",
      title: "پروژه",
      description: "برای آینده برنامه‌ریزی کنید: هدف‌گذاری، مدیریت ریسک و ساخت یک نقشه بلندمدت برای آرامش مالی.",
      schemaJson: {
        fields: [
          { key: "currentAge", label: "سن فعلی", type: "number", required: true },
          { key: "retirementAge", label: "سن بازنشستگی هدف", type: "number", required: true },
          { key: "currentSavings", label: "پس‌انداز فعلی بازنشستگی", type: "number", required: true },
          { key: "monthlyContribution", label: "مشارکت/واریز ماهانه", type: "number", required: true },
          { key: "annualReturn", label: "بازده سالانه مورد انتظار (%)", type: "number", required: true },
        ],
        computations: ["projectedBalance", "yearsToRetirement", "totalContributed", "totalGrowth"],
      },
    },
  ];

  for (const skill of insertedSkills) {
    const skillLessons = lessonsMap[skill.title] || [];
    for (let i = 0; i < skillLessons.length; i++) {
      const lessonData = skillLessons[i];
      const [lesson] = await db
        .insert(schema.lessons)
        .values({
          skillId: skill.id,
          title: lessonData.title,
          orderIndex: i,
          contentJson: lessonData.content,
          isPublished: true,
        })
        .returning();

      const skillExercises = exercisesMap[skill.title] || [];
      const matchingExercises = skillExercises.find((e) => e.lessonTitle === lessonData.title);
      if (matchingExercises) {
        for (let j = 0; j < matchingExercises.exercises.length; j++) {
          const ex = matchingExercises.exercises[j];
          await db.insert(schema.exercises).values({
            lessonId: lesson.id,
            type: ex.type,
            prompt: ex.prompt,
            optionsJson: ex.options,
            answerJson: ex.answer,
            explanation: ex.explanation,
            hint: ex.hint,
            tagsJson: [skill.title.toLowerCase()],
            orderIndex: j,
          });
        }
      }
    }

    const projectData = projectsData.find((p) => p.skillTitle === skill.title);
    if (projectData) {
      await db.insert(schema.projects).values({
        skillId: skill.id,
        title: projectData.title,
        description: projectData.description,
        schemaJson: projectData.schemaJson,
      });
    }
  }

  await db.insert(schema.achievements).values([
    { key: "first_lesson", title: "گام‌های اول", description: "اولین درس خود را کامل کنید", iconName: "award" },
    { key: "streak_3", title: "روی دور تند", description: "سری ۳روزه را حفظ کنید", iconName: "zap" },
    { key: "first_project", title: "Builder", description: "پروژه", iconName: "tool" },
    { key: "streak_7", title: "یادگیرنده پرتلاش", description: "سری ۷روزه را حفظ کنید", iconName: "trending-up" },
    { key: "xp_100", title: "باشگاه صدتایی‌ها", description: "کسب ۱۰۰ امتیاز", iconName: "star" },
  ]);

  console.log("مقداردهی اولیه با موفقیت انجام شد!");
  await pool.end();
}

seed().catch(console.error);
